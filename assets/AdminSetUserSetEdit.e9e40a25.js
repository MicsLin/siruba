import{u as e,m as a,r as l,a as t,A as s,c as u,w as r,b as n,d as p,g as o,t as i,E as v,k as c,B as d,J as m,F as f,y as h,L as S,l as x,f as g,z as U,o as E,n as y}from"./vendor.ee801e80.js";import{d as b}from"./index.9e640917.js";import{P as w}from"./pagesPermitList.f2fb112f.js";const I={class:"mt-12 flex sm:block py-4 sm:mb-4 text-4xl text-orange-siruba"},L={class:"flex md:block"},k={class:"flex lg:block w-full mr-5"},P={class:"mr-5 lg:mr-0 lg:mb-5 w-full shadow sirubaBorder"},D={class:"flex items-center h-16 pl-8 sm:pl-4 pr-10 sm:pr-4 titleStyle border-b"},_={class:"flex items-center text-xl"},N=o("svg",{class:"stroke-current stroke-2 w-7 h-7 text-blue-title-text",fill:"#d9edf7",viewBox:"0 0 44 44"},[o("path",{d:"M1 38.207c0-1.983 1.168-3.777 2.983-4.575 2.325-1.022 5.505-2.42 7.638-3.366 1.925-.85 2.34-1.363 4.28-2.235 0 0 .2-1.012.13-1.615h1.516s.347.206 0-2.176c0 0-1.85-.5-1.936-4.294 0 0-1.39.476-1.475-1.823-.058-1.56-1.243-2.912.462-4.03l-.867-2.38s-1.733-9.617 3.25-8.206c-2.1-2.56 11.92-5.117 12.83 3 0 0 .65 4.38 0 7.38 0 0 2.05-.24.68 3.765 0 0-.75 2.882-1.907 2.235 0 0 .19 3.646-1.632 4.265 0 0 .13 1.94.13 2.073l1.736.265s-.26 1.588.043 1.764c0 0 2.49 1.29 4.506 2.074 2.378.917 4.86 2.002 6.714 2.84 1.788.81 2.932 2.592 2.93 4.555 0 .847.003 1.63.01 2.007.023 1.224-.873 2.27-2.1 2.27H3.105C1.943 42 1 41.057 1 39.895v-1.688z",class:"line"})],-1),T={class:"ml-3"},A={class:"px-4 sm:px-2 py-6 sm:py-4 text-white text-sm"},G=["onSubmit"],$={class:"flex"},O={class:"mr-2 w-full"},C={class:"pl-2 text-purple-500"},B={class:"w-full"},j={class:"pl-2 text-purple-500"},V={class:"flex my-2"},R={class:"mr-2 w-full"},q={class:"pl-2 text-purple-500"},J={class:"w-full"},F={class:"pl-2 text-purple-500"},M={class:"flex"},z={class:"mr-2 w-full"},H={class:"pl-2 text-purple-500"},K=["value"],W={class:"w-full"},Y={class:"pl-2 text-purple-500"},Q={value:"",disabled:"",hidden:""},X=["value"],Z={class:"my-2 w-full shadow-2xl"},ee={class:"tableThStyle"},ae={class:"py-3 pl-2 text-left"},le={class:"flex items-center tableBorderStyle py-3 pl-2 hover:bg-purple-400"},te={for:"check_all",class:"w-full cursor-pointer"},se={class:"px-8 lg:px-4 py-4 overflow-hidden tableBorderStyle"},ue={class:"flex flex-wrap"},re=["id","value"],ne=["for"],pe={type:"submit",class:"mr-2 btn btnBlueColor"},oe={type:"button",class:"btn btnGrayColor"},ie={setup(ie){const ve=e(),ce=a(),de=l(ce.locale.value),me=t(),fe=s(),he=l(fe.params.adminId);!function(){if(he.value)sessionStorage.setItem("userSetEdit",JSON.stringify(he.value));else{let e=sessionStorage.getItem("userSetEdit");he.value=JSON.parse(e)}}();const Se=u((()=>ve.state.resData.adminId)),xe=u((()=>ve.state.resData.token)),ge=u((()=>ve.state.serverURL)),Ue=l([]),Ee=l([]),ye=l(""),be=l(),we=l(""),Ie=l(""),Le=l(""),ke=l(""),Pe=l([0]),De=l(""),_e=l(""),Ne=l([{title:"English",description:"en"},{title:"繁體",description:"tw"},{title:"簡体",description:"cn"},{title:"日本語",description:"jp"}]),Te=function(){"tw"==de.value&&(De.value="選擇群組",_e.value="選擇語言"),"cn"==de.value&&(De.value="选择群组",_e.value="选择语言"),"jp"==de.value&&(De.value="グループを選択する",_e.value="言語を選択してください"),"en"==de.value&&(De.value="Select Group",_e.value="Choose a language")};Te();const Ae=l(!1),Ge=l([]),$e=function(){return"tw"==de.value?Ge.value=w.tw:"cn"==de.value?Ge.value=w.cn:"jp"==de.value?Ge.value=w.jp:"en"==de.value?Ge.value=w.en:void 0};$e();const Oe=function(){if(Ae.value=!Ae.value,Pe.value=[0],Ae.value){Pe.value=[];for(let e=0;e<Ge.value.length;e++)Pe.value.push(e)}};!function(){let e=new FormData;e.append("token",xe.value),e.append("adminId",he.value),U.post(`http://${ge.value}/userset_edit.php`,e).then((e=>{if(b(e.data),1==e.data.status){let a=e.data.data.adminGroup,l=Object.keys(a);Ee.value=l,l.forEach((e=>{Ue.value.push(a[e])}));let t=e.data.data;ye.value=t.userData.userName,be.value=t.userData.userEmployeeNumber,we.value=t.userData.userAccount,Ie.value=t.userData.userPassword,Le.value=Ee.value.findIndex((e=>e==t.userData.userGroup)),ke.value=t.userData.userLang;let s=t.userData.userPagesPermit.split(","),u=[];s.forEach((e=>u.push(parseInt(e)-1))),Ge.value.length==u.length?Oe():Pe.value=u}else me.push("/user_set")})).catch((e=>{me.push("/user_set")}))}();const Ce=function(){let e=new FormData;e.append("token",xe.value),e.append("UserId",he.value),e.append("UserName",ye.value),e.append("EmployeeIDNumber",be.value),e.append("UserAccount",we.value),e.append("UserPassword",Ie.value),e.append("UserGroup",Ee.value[Le.value]),e.append("UserLang",ke.value),Pe.value.length>0&&Pe.value.forEach((a=>{e.append(`PagesPermit[${a+1}]`,1)})),U.post(`http://${ge.value}/userset_update.php`,e).then((e=>{if(b(e.data),1==e.data.status){if(Se.value==he.value){let e=JSON.parse(sessionStorage.getItem("users"));e.adminName=ye.value,e.adminGroup=Ee.value[Le.value],e.adminLang=ke.value,e.adminPagesPermit=Pe.value.map((e=>e+1)).join(","),sessionStorage.setItem("users",JSON.stringify(e));let a={adminName:ye.value,adminGroup:Ee.value[Le.value],adminLang:ke.value,adminPagesPermit:Pe.value.map((e=>e+1)).join(",")};ve.commit("userEdit",a)}alert("success"),me.push({name:"UserSet",params:{UserName:ye.value}})}else 2==e.data.status?me.push("/login"):alert(e.data.message)})).catch((e=>{alert("Fail,please try again")}))};return r((()=>ce.locale.value),(e=>{de.value=e,Te(),$e()})),(e,a)=>{const l=n("router-link");return E(),p(f,null,[o("h1",I,i(e.$t("UserSetEdit.UEDIT_USEREDITING")),1),o("div",L,[o("div",k,[o("div",P,[o("div",D,[o("span",_,[N,o("span",T,i(e.$t("UserSetEdit.UEDIT_USEREDITING")),1)])]),o("div",A,[o("form",{action:"",onSubmit:v(Ce,["prevent"])},[o("div",$,[o("div",O,[o("span",C,i(e.$t("UserSet.USET_USERNAME"))+":",1),c(o("input",{type:"text",class:"form-control myInput w-full","onUpdate:modelValue":a[0]||(a[0]=e=>ye.value=e),required:""},null,512),[[d,ye.value]])]),o("div",B,[o("span",j,i(e.$t("UserSet.USET_EMPLOYEEID"))+":",1),c(o("input",{type:"text",class:"form-control myInput w-full","onUpdate:modelValue":a[1]||(a[1]=e=>be.value=e),required:""},null,512),[[d,be.value]])])]),o("div",V,[o("div",R,[o("span",q,i(e.$t("UserSet.USET_ACCOUNT"))+":",1),c(o("input",{type:"text",class:"form-control myInput w-full","onUpdate:modelValue":a[2]||(a[2]=e=>we.value=e),required:""},null,512),[[d,we.value]])]),o("div",J,[o("span",F,i(e.$t("UserSet.USET_PASSWORD"))+":",1),c(o("input",{type:"password",class:"form-control myInput w-full","onUpdate:modelValue":a[3]||(a[3]=e=>Ie.value=e),required:""},null,512),[[d,Ie.value]])])]),o("div",M,[o("div",z,[o("span",H,i(e.$t("UserSet.USET_SELECTGROUP"))+":",1),c(o("select",{class:"w-full myInputSearch","onUpdate:modelValue":a[4]||(a[4]=e=>Le.value=e),required:""},[(E(!0),p(f,null,h(Ue.value,((e,a)=>(E(),p("option",{value:a,key:a},i(e),9,K)))),128))],512),[[m,Le.value]])]),o("div",W,[o("span",Y,i(e.$t("Personal.PSL_SELECTLANG"))+":",1),c(o("select",{class:"w-full myInputSearch","onUpdate:modelValue":a[5]||(a[5]=e=>ke.value=e),required:""},[o("option",Q,i(_e.value),1),(E(!0),p(f,null,h(Ne.value,((e,a)=>(E(),p("option",{key:"language"+a,value:e.description},i(e.title),9,X)))),128))],512),[[m,ke.value]])])]),o("table",Z,[o("thead",null,[o("tr",ee,[o("th",ae,i(e.$t("UserSetEdit.UEDIT_PAGEPERMISSION")),1)])]),o("tbody",null,[o("tr",null,[o("td",le,[c(o("input",{type:"checkbox",id:"check_all",class:"mr-2 cursor-pointer",onClick:a[6]||(a[6]=e=>Oe()),"onUpdate:modelValue":a[7]||(a[7]=e=>Ae.value=e)},null,512),[[S,Ae.value]]),o("label",te,i(e.$t("UserSet.USET_SELECTALL")),1)])]),o("tr",null,[o("td",se,[o("ul",ue,[(E(!0),p(f,null,h(Ge.value,((e,l)=>(E(),p("li",{class:y(["flex items-center mb-1 w-2/6 sm:w-6/12",[0==l?"hidden":""]]),key:"pagesPermitArray"+l},[c(o("input",{type:"checkbox",class:"mr-2 cursor-pointer",id:"check"+l,value:l,onChange:a[8]||(a[8]=e=>{Pe.value.length==Ge.value.length?Ae.value=!0:Ae.value=!1}),"onUpdate:modelValue":a[9]||(a[9]=e=>Pe.value=e)},null,40,re),[[S,Pe.value]]),o("label",{for:"check"+l,class:"cursor-pointer"},i(e),9,ne)],2)))),128))])])])])]),o("button",pe,i(e.$t("GLOBAL.GLOBAL_UPDATE")),1),x(l,{to:"/user_set"},{default:g((()=>[o("button",oe,i(e.$t("GLOBAL.GLOBAL_BACK")),1)])),_:1})],40,G)])])])])],64)}}};export{ie as default};
